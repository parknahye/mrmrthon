# ğŸš© ë§ˆë¼í†¤ ëŒ€íšŒ ê²°ê³¼ ê¸°ë¡ ì‹œìŠ¤í…œ. ë§ˆë¼ë§ˆë¼í†¤, mrmrthon!

<br>

## âš’ï¸ ì•„í‚¤í…ì³
![fian_diagram](https://github.com/cs-devops-bootcamp/devops-04-Final-Team2/assets/126468493/1810e67b-7339-4ee7-b6b8-ba21218f0ecc)<br>
> 1. ê°œë°œìê°€ ìƒˆë¡œìš´ ë²„ì „ì„ ë¦´ë¦¬ì¦ˆí•˜ë©´ Github Actionì„ í†µí•´ ìë™í™”ê°€ë˜ì–´ ì§„í–‰ë©ë‹ˆë‹¤. S3ì— ì •ì  ì›¹í˜ì´ì§€ íŒŒì¼ ì—…ë¡œë“œ, ECR ì´ë¯¸ì§€ Push, ìƒˆ íƒœìŠ¤í¬ ì •ì˜ ìƒì„±, ECS ì„œë¹„ìŠ¤ ì—…ë°ì´íŠ¸, ëŒë‹¤ í•¨ìˆ˜ ë°°í¬ê°€ í¬í•¨ë©ë‹ˆë‹¤.
> 2. ê° ì„œë¹„ìŠ¤ì˜ CloudWatchì§€í‘œë¥¼ ë§¤íŠ¸ë¦­ìœ¼ë¡œí•˜ì—¬ Grafana Dashboardì— í‘œì‹œë©ë‹ˆë‹¤.
> 3. ì‚¬ìš©ìê°€ Roue53ì„ í†µí•´ ë„ë©”ì¸ìœ¼ë¡œ ì ‘ì†í•˜ë©´ CloudFrontë¥¼ í†µí•´ S3ì— ì—…ë¡œë“œëœ ì •ì  ì›¹í˜ì´ì§€ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤.
> 4. Userì„œë²„ì— apiìš”ì²­ì„ ë³´ë‚´ CRUDì‘ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. í•´ë‹¹ ì‘ì—…ì— ëŒ€í•œ ê²°ê³¼ë¡œ user_dbì— ì ‘ì†í•˜ì—¬ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê·¸ ì¤‘ ë¡œê·¸ì¸ ì‘ì—…ì— ì„±ê³µí•˜ë©´ í† í°ì„ ë°œê¸‰í•©ë‹ˆë‹¤.
> 5. Headerì— í† í°ì„ í¬í•¨í•˜ì—¬ Main ì„œë²„ì— apiìš”ì²­ì„ ë³´ë‚´ CRUDì‘ì—…ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤. í•´ë‹¹ ì‘ì—…ì— ëŒ€í•œ ê²°ê³¼ë¡œ main_dbì™€ user_dbì— ì ‘ì†í•˜ì—¬ ê°’ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ê° ì‘ì—…ì— ë”°ë¼ í† í° ê°’ì´ ì‚¬ìš©ë©ë‹ˆë‹¤.
> 6. main_dbì˜ official_record í…Œì´ë¸”ì— ê°’ì´ ì¶”ê°€ë˜ë©´, ì´ë¥¼ íŠ¸ë¦¬ê±°ë¡œ official_record_lambdaê°€ ì‘ë™í•©ë‹ˆë‹¤. í•´ë‹¹ ëŒë‹¤ëŠ” ì¶”ê°€ëœ ê°’ì— ëŒ€í•œ ë‚´ìš©ì„ SNSë¡œ ì „ë‹¬í•©ë‹ˆë‹¤.
> 7. SNSë¥¼ êµ¬ë…ì¤‘ì¸ SQSì— í¬ì¸íŠ¸ ê°’ ë³€ë™ ë©”ì„¸ì§€ê°€ ì „ë‹¬ë©ë‹ˆë‹¤. í•´ë‹¹ SQSë¥¼ íŠ¸ë¦¬ê±°ë¡œ point_increase_lambdaê°€ ì‘ë™í•©ë‹ˆë‹¤. í•´ë‹¹ ëŒë‹¤ëŠ” SQSë¥¼ í†µí•´ ë°›ì€ ë©”ì„¸ì§€ ê°’ìœ¼ë¡œ user_dbì— í¬ì¸íŠ¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
> 8. SNSë¥¼ êµ¬ë… ì¤‘ì¸ webhook_lambdaì— ì ìˆ˜ ì¶”ê°€ ì™„ë£Œ ë©”ì„¸ì§€ê°€ ì „ë‹¬ë©ë‹ˆë‹¤. í•´ë‹¹ ëŒë‹¤ëŠ” discordë¥¼ í†µí•´ í¬ì¸íŠ¸ ì¶”ê°€ ì™„ë£Œ ì•ŒëŒì„ ì „ì†¡í•©ë‹ˆë‹¤.
<br>

## ğŸ” ê°œìš”
> - ê°œì¸ ì‚¬ìš©ìì™€ ëŒ€íšŒì£¼ìµœìë¥¼ ìœ„í•œ ë§ˆë¼í†¤ ê²°ê³¼ ê¸°ë¡ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.<br>
> - ê°œì¸ ì‚¬ìš©ìëŠ” ìì‹ ì˜ ê¸°ë¡ì„ ì…ë ¥í•˜ê³  ê´€ë¦¬í•˜ë©°, ëŒ€íšŒ ì£¼ìµœìëŠ” ëŒ€íšŒì— ì°¸ê°€í•˜ëŠ” ê°œì¸ ì‚¬ìš©ìë“¤ì˜ ê¸°ë¡ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> - ê°œì¸ ì‚¬ìš©ìì™€ ëŒ€íšŒ ì£¼ìµœìëŠ” ê°ê°ì˜ ê¶Œí•œì— ë”°ë¼ ê¸°ë¡ ì¡°íšŒ, ì…ë ¥, ìˆ˜ì •, ì‚­ì œë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
> - ì´ë¥¼ í†µí•´ ì‚¬ìš©ìë“¤ì€ í¸ë¦¬í•˜ê²Œ ë§ˆë¼í†¤ ê²°ê³¼ë¥¼ ê¸°ë¡í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
<br>

## ğŸ“‘ ì¸í”„ë¼ ì†Œê°œ
> 1. **ê°€ìš©ì„±, ë‚´ê²°í•¨ì„±, í™•ì¥ì„±, ë³´ì•ˆì„±ì´ ê³ ë ¤ëœ ì„œë¹„ìŠ¤**
>     - Auto scailing, JWT, ALB, CloudFront, Route53ë¥¼ í™œìš©í•˜ì—¬ ì„œë¹„ìŠ¤ êµ¬ì„±ì„ ê°•í™”í•˜ì˜€ìŠµë‹ˆë‹¤.
> 3. **CI/CD íŒŒì´í”„ë¼ì¸**
>    - GitHub Actionsì„ í™œìš©í•˜ì—¬ CI/CD íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤.<br>
> 4. **2ê°œì˜ ë°ì´í„°ë² ì´ìŠ¤**
>    - ìœ ì € ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ìˆëŠ” ìœ ì € ë°ì´í„°ë² ì´ìŠ¤(user_db)ì™€ ë©”ì¸ ë°ì´í„°ë² ì´ìŠ¤(main_db)ë¡œ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤.<br>
> 5. **ëŠìŠ¨í•œ ê²°í•©**
>    - Lambda, SQSë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ ê°„ ëŠìŠ¨í•œ ê²°í•©ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.<br>
> 6. **ì‹œê°í™”ëœ ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ**
>    - Grafanaë¥¼ í™œìš©í•˜ì—¬ ì‹œìŠ¤í…œì˜ ìƒíƒœë¥¼ ì‹œê°í™”í•˜ê³  ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤.
<br>

## âœ”ï¸ ì£¼ìš” ê¸°ëŠ¥ ì†Œê°œ
> 1. **ê°œì¸ ì‚¬ìš©ìì™€ ëŒ€íšŒ ì£¼ìµœìëŠ” ë¡œê·¸ì¸ ê¸°ëŠ¥ì„ í†µí•´ í† í°ì„ ë°œê¸‰ë°›ìŠµë‹ˆë‹¤. (https://www.mrmrthon.click)**
>    - '0'ì¸ ê²½ìš°, ê°œì¸ ì‚¬ìš©ì / '1'ì¸ ê²½ìš°, ëŒ€íšŒ ì£¼ìµœìë¡œ ë¶„ë¦¬
>      - user_dbì˜ GET /users/login ì—”ë“œí¬ì¸íŠ¸ì—ì„œ user_type ê°’ì„ í™•ì¸
>      - ì£¼ìµœìì¸ ê²½ìš° "ì£¼ìµœìë‹˜ í™˜ì˜í•©ë‹ˆë‹¤", ê°œì¸ ì‚¬ìš©ìì¸ ê²½ìš° "ê°œì¸ ì‚¬ìš©ìë‹˜ í™˜ì˜í•©ë‹ˆë‹¤" ë¼ëŠ” ë©”ì‹œì§€ì™€ í•¨ê»˜ í† í°ì´ ë°˜í™˜
> 2. **ì¸ì¦ëœ ê°œì¸ ì‚¬ìš©ì**
>    - íŠ¹ì • ë§ˆë¼í†¤ ëŒ€íšŒì— ì°¸ê°€ ì‹ ì²­ ë° ì·¨ì†Œ
>    - ìì‹ ì˜ ë¹„ê³µì‹ ê¸°ë¡ ì…ë ¥, ì¡°íšŒ, ì‚­ì œ
>    - ê³µì‹ ê°œì¸ ì ìˆ˜ ì¡°íšŒ
> 3. **ëŒ€íšŒ ì£¼ìµœì**
>    - ì°¸ê°€ì ì¡°íšŒ
>    - ì°¸ê°€ìë“¤ì— ëŒ€í•œ ê³µì‹ ê¸°ë¡ ì…ë ¥, ì¡°íšŒ, ì‚­ì œ
>    - ëŒ€íšŒë³„ ì°¸ê°€ìë“¤ì˜ ì ìˆ˜ ì¶”ê°€
>    - ìƒˆë¡œìš´ ë§ˆë¼í†¤ ìƒì„±, ë§ˆë¼í†¤ ìˆ˜ì •, ë§ˆë¼í†¤ ì‚­ì œ
> 4. **í…Œì´ë¸” ë³„ ì£¼ìš” ê¸°ëŠ¥**<br>
>  ![20230627_093610](https://github.com/cs-devops-bootcamp/devops-04-Final-Team2/assets/126468493/550c102c-ef78-4540-9b2a-b4ef0ea80e10)<br>
> 5. **CI/CD**
>    - GitHub Actionì„ í†µí•´ ECR,ECS,Lambda ìë™í™”
> 6. **ëª¨ë‹ˆí„°ë§**
>    - ECS&RDS : CPU Utilization, Memorey Utilization
>    - RDS : CPU Utilization
>    - Lambda : Duration
>    - SQS : Number Of Messages
>    - DLQ : Count of DLQ Message
>    - DynamoDB : Write Capacity Utilization, Read Capacity Utilization
<br>

## ğŸ™‹â€â™€ï¸ ë‚˜ì˜ ì—­í• 
- RDS MySQL, DynamoDBë¥¼ ì‚¬ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ êµ¬í˜„
    - ë°ì´í„°ë² ì´ìŠ¤ë¥¼ êµ¬ì„±í•˜ê³  í…Œì´ë¸”ê³¼ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë§Œë“¤ì—ˆë‹¤. 
      ![image](https://github.com/parknahye/mrmrthon/assets/127065825/635b444c-0c51-4bc6-a932-4bfd70d16a14)

- DynamoDB ì—°ë™  Rest API ê°œë°œ
    - aws-sdk ë¥¼ ì‚¬ìš©í•˜ì—¬ DynamoDB ì—°ë™í•˜ì˜€ë‹¤.
    - ê¸°ëŠ¥ë³„ ë‹¤ì–‘í•œ CRUD APIë¥¼ ê°œë°œí•˜ì˜€ë‹¤
    - api list

      ![image](https://github.com/parknahye/mrmrthon/assets/127065825/4242ed5e-dd0b-476b-a995-0053923f5a43)

- official_record_lamda ëŒë‹¤ í•¨ìˆ˜ êµ¬í˜„
    - DynamoDBì„ íŠ¸ë¦¬ê±°ë¡œ í•˜ì—¬ í…Œì´ë¸”ì¸ official_record í…Œì´ë¸”ì— ë°ì´í„°ê°€ insert ê°€ ë˜ë©´ sqsë¥¼ í†µí•˜ì—¬ point_increase_lamda ëŒë‹¤ë¡œ ê°’ì„ ì „ë‹¬í•˜ë„ë¡ ëŠìŠ¨í•œ ê²°í•©ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.

- ì›¹í›… êµ¬í˜„
    - snsë¥¼ ì‚¬ìš©í•˜ì—¬ ì›¹í›…ì„ ë§Œë“¤ì–´ ë””ìŠ¤ì½”ë“œë¡œ ì•Œë¦¼ ë©”ì‹œì§€ê°€ ì˜¤ë„ë¡ ê°œë°œí•˜ì˜€ë‹¤.
      ![image](https://github.com/parknahye/mrmrthon/assets/127065825/b298664e-a2d9-4d06-81c6-0767d39c66a9)
      
- ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ êµ¬í˜„
    - AWS Cloud Watch ì˜ ì„œë¹„ìŠ¤ë¥¼ Grafanaë¡œ import í•˜ì—¬ êµ¬í˜„í•˜ì˜€ë‹¤.
      ![image](https://github.com/parknahye/mrmrthon/assets/127065825/ff3aa59a-8cc1-4744-ab73-31a98f52d8fe)

- IaC ì‘ì„±
    - í…Œë¼í¼ ì½”ë“œë¡œ IaCë¥¼ ì‘ì„±í•˜ì—¬ ì¸í”„ë¼ ê°œë°œì„ ê°„í¸í•˜ê²Œ ë§Œë“¤ì—ˆë‹¤.

## ğŸƒâ€â™€ï¸ Install Dependencies

```
npm install express
npm install jsonwebtoken
npm start
```
- express: ^4.18.2
- aws-sdk: ^2.1399.0
- jsonwebtoken: ^9.0.0
- mysql: ^2.18.1
